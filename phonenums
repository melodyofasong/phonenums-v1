import phonenumbers
from phonenumbers import PhoneNumberMatcher
import csv

file_path = input("Enter path to your OCR text file: )

with open(file_path, 'r', encoding='utf-8') as f:
    epaper_text = f.read()

matcher = PhoneNumberMatcher(epaper_text, "IN")
phones = []

for match in matcher:
    original_num = phonenumbers.format_number(match.number, phonenumbers.PhoneNumberFormat.NATIONAL)
    phones.append(original_num)  

phones = list(set(phones))

with open('epaper_phones.csv', 'w', newline='', encoding='utf-8') as csvfile:
    writer = csv.writer(csvfile)
    writer.writerow(['Phone Number'])
    writer.writerows([[phone] for phone in phones]) 

print(f"âœ… Saved {len(phones)} unique phones to epaper_phones.csv")
print("Extracted phones:", phones)


